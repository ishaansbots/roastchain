import { ethers } from 'ethers';
import fs from 'fs';

// Simplified RoastToken bytecode (minimal ERC20)
const ROAST_TOKEN_BYTECODE = "0x608060405234801561000f575f80fd5b506040518060400160405280601181526020017f526f617374436861696e20546f6b656e0000000000000000000000000000000081525060039081610054919061029c565b506040518060400160405280600581526020017f524f4153540000000000000000000000000000000000000000000000000000008152506004908161009a919061029c565b506012600560006101000a81548160ff021916908360ff1600179055506b033b2e3c9fd0803ce8000000600681905550600654600160003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055503373ffffffffffffffffffffffffffffffffffffffff165f73ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60065460405161017d9190610375565b60405180910390a361038e565b5f81519050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffd5b5f60028204905060018216806101ff57607f821691505b602082108103610212576102116101c1565b5b50919050565b5f819050815f5260205f209050919050565b5f6020601f8301049050919050565b5f82821b905092915050565b5f600883026102747fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82610239565b61027e8683610239565b95508019841693508086168417925050509392505050565b5f6102ae6102a96102a484610375565b61037e565b610375565b9050919050565b5f819050919050565b6102c783610295565b6102db6102d3826102b5565b848454610245565b825550505050565b5f90565b6102ef6102e3565b6102fa8184846102be565b505050565b5b8181101561031d576103125f826102e7565b600181019050610300565b5050565b601f8211156103625761033381610218565b61033c8461022a565b8101602085101561034b578190505b61035f6103578561022a565b8301826102ff565b50505b505050565b5f82821c905092915050565b5f6103825f1984600802610367565b1980831691505092915050565b5f61039a8383610373565b9150826002028217905092915050565b6103b38261018a565b67ffffffffffffffff8111156103cc576103cb610194565b5b6103d682546101ee565b6103e1828285610321565b5f60209050601f831160018114610412575f8415610400578287015190505b61040a858261038f565b865550610471565b601f19841661042086610218565b5f5b8281101561044757848901518255600182019150602085019450602081019050610422565b8683101561046457848901516104609826158f610373565b8355505b6001600288020188555050505b505050505050565b610ac58061048b5f395ff3fe608060405234801561000f575f80fd5b5060043610610091575f3560e01c8063313ce56711610064578063313ce5671461013157806370a082311461014f57806395d89b411461017f578063a9059cbb1461019d578063dd62ed3e146101cd57610091565b806306fdde0314610095578063095ea7b3146100b357806318160ddd146100e357806323b872dd14610101575b5f80fd5b61009d6101fd565b6040516100aa9190610878565b60405180910390f35b6100cd60048036038101906100c891906108f0565b61028a565b6040516100da9190610948565b60405180910390f35b6100eb610377565b6040516100f89190610970565b60405180910390f35b61011b60048036038101906101169190610989565b61037d565b6040516101289190610948565b60405180910390f35b610139610647565b60405161014691906109f4565b60405180910390f35b61016960048036038101906101649190610a0d565b610659565b6040516101769190610970565b60405180910390f35b61018761066e565b6040516101949190610878565b60405180910390f35b6101b760048036038101906101b291906108f0565b6106fb565b6040516101c49190610948565b60405180910390f35b6101e760048036038101906101e29190610a38565b61086c565b6040516101f49190610970565b60405180910390f35b60603f8054610b0b90610aa3565b80601f0160208091040260200160405190810160405280929190818152602001828054610b3790610aa3565b8015610b825780601f10610b5957610100808354040283529160200191610b82565b820191905f5260205f20905b815481529060010190602001808311610b6557829003601f168201915b5050505050905090565b5f8160025f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f20819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92584604051610c759190610970565b60405180910390a36001905092915050565b60065481565b5f8160015f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205410158015610d22575060025f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205482115b610d2a575f80fd5b8160015f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610d769190610b00565b925050819055508160015f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825401925050819055508160025f8673ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f828254610e4d9190610b00565b925050819055508273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef84604051610eb19190610970565b60405180910390a3600190509392505050565b60055f9054906101000a900460ff1681565b6001602052805f5260405f205f915090505481565b60606004805461067d90610aa3565b80601f01602080910402602001604051908101604052809291908181526020018280546106a990610aa3565b80156106f45780601f106106cb576101008083540402835291602001916106f4565b820191905f5260205f20905b8154815290600101906020018083116106d757829003601f168201915b5050505050905090565b5f8160015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f2054101561074657505f610866565b8160015f3373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f8282546107929190610b00565b925050819055508160015f8573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020015f205f82825401925050819055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040516108419190610970565b60405180910390a360019050610866565b92915050565b6002602052815f5260405f20602052805f5260405f205f91509150505481565b5f81519050919050565b5f82825260208201905092915050565b8281835e5f83830152505050565b5f601f19601f8301169050919050565b5f6108b882610886565b6108c28185610890565b93506108d28185602086016108a0565b6108db816108aa565b840191505092915050565b5f6020820190508181035f8301526108fe81846108ae565b905092915050565b5f80fd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6109338261090a565b9050919050565b61094381610929565b811461094d575f80fd5b50565b5f8135905061095e8161093a565b92915050565b5f819050919050565b61097681610964565b8114610980575f80fd5b50565b5f813590506109918161096d565b92915050565b5f80604083850312156109ad576109ac610906565b5b5f6109ba85828601610950565b92505060206109cb85828601610983565b9150509250929050565b5f6109df8261090a565b9050919050565b6109ef816109d5565b82525050565b5f602082019050610a085f8301846109e6565b92915050565b5f60208284031215610a2357610a22610906565b5b5f610a3084828501610950565b91505092915050565b5f8060408385031215610a4f57610a4e610906565b5b5f610a5c85828601610950565b9250506020610a6d85828601610950565b9150509250929050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52602260045260245ffdfea26469706673582212206e8f9ab5b7f3e4c2d1b8a9c0e5f1d2c3b4a5968778695a4b3c2d1e0f112233445164736f6c63430008140033";

const PRIVATE_KEY = "0x52c052d430f89b53b4926ea76987f56c24f73c3a84452f70adfa11e34cc91c2d";
const RPC_URL = "https://mainnet.base.org";

console.log("üî• Deploying ROAST Token to Base...\n");

try {
    const provider = new ethers.JsonRpcProvider(RPC_URL);
    const wallet = new ethers.Wallet(PRIVATE_KEY, provider);
    
    console.log("Deployer:", wallet.address);
    
    const balance = await provider.getBalance(wallet.address);
    console.log("Balance:", ethers.formatEther(balance), "ETH\n");
    
    if (balance === 0n) {
        console.error("‚ùå No balance!");
        process.exit(1);
    }
    
    // Deploy token
    console.log("üìù Deploying ROAST Token...");
    
    const tx = await wallet.sendTransaction({
        data: ROAST_TOKEN_BYTECODE,
        gasLimit: 1500000
    });
    
    console.log("Transaction hash:", tx.hash);
    console.log("Waiting for confirmation...");
    
    const receipt = await tx.wait();
    const tokenAddress = receipt.contractAddress;
    
    console.log("\n‚úÖ TOKEN DEPLOYED!\n");
    console.log("==================");
    console.log("Token Address:", tokenAddress);
    console.log("Name: RoastChain Token");
    console.log("Symbol: ROAST");
    console.log("Decimals: 18");
    console.log("Supply: 1,000,000,000 ROAST");
    console.log("\nExplorer:", "https://basescan.org/address/" + tokenAddress);
    
    // Save deployment
    fs.writeFileSync('token-deployment.json', JSON.stringify({
        network: 'base',
        chainId: 8453,
        tokenAddress,
        deployer: wallet.address,
        txHash: tx.hash,
        timestamp: new Date().toISOString()
    }, null, 2));
    
    console.log("\nüìÑ Saved to token-deployment.json");
    
} catch (error) {
    console.error("‚ùå Error:", error.message);
    process.exit(1);
}
